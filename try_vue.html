<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Marimekko Inventory Status Component</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="src/css/lib/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" media="screen" href="dest/css/global.css" />
    <link rel="stylesheet" href="src/css/lib/select2.min.css">
    <link rel="stylesheet" type="text/css" media="screen" href="dest/css/mari-select2.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="dest/css/inventory.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="dest/css/reserve-collect.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="dest/css/button.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="dest/css/input.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="dest/css/qty-selector.css" />
    <script src='src/js/lib/jquery-3.3.1.min.js'></script>
    <script src="src/js/lib/bootstrap.min.js"></script>
    <script src="src/js/lib/select2.min.js"></script>
    <script src="src/js/lib/vue.js"></script>
    <script src="dest/js/inventory.js"></script>
    <script src="dest/js/form-validation.js"></script>
    <script src="dest/js/qty-selector.js"></script>
    <script src="dest/js/email-me.js"></script>
</head>

<body class='catalog-product-view'>
    <ul class="list-size" style='display: none'>
        <li>haha</li>
        <li>haha</li>
    </ul>
    <div class='rich-product-page product-page-wrapper'>
        <!-- Raw data of onesize product attributes -->
        <div class="product-data-mine1" data-attributeids="[141]" data-messagemoreoptions="You must specify all product options before adding it to the cart" data-confproductid="49337" data-lookup="{'69':{'qty':9991,'stock_status':1,'sku':'6411253780900','price':'\n\n\n    <div class=\'price-wrapper\' itemprop=\'offers\' itemscope itemtype=\'http:\/\/schema.org\/Offer\'>\n                \n    <div class=\'price-box\'>\n                                                            <span class=\'regular-price\' id=\'product-price-18848\' itemprop=\'price\'>\n                                           <span class=\'price\'>37,00\u00a0EUR<\/span>                                    <\/span>\n                        \n    \n        \n    <\/div>\n\n        <meta itemprop=\'priceCurrency\' content=\'EUR\' \/>\n        <meta itemprop=\'availability\' content=\'http:\/\/schema.org\/InStock \' \/>\n    <\/div>\n\n','price_numeric':37,'size':'onesize','id':18848,'parent_attribute_code':'size'}}"></div>
        <!-- Raw data of sizable product attributes -->
        <div class="product-data-mine2" data-attributeids="[141]" data-messagemoreoptions="You must specify all product options before adding it to the cart" data-confproductid="51745" data-lookup="{'19':{'qty':6,'stock_status':1,'sku':'6411254317884','price':'\n\n\n    <div class=\'price-wrapper\' itemprop=\'offers\' itemscope itemtype=\'http:\/\/schema.org\/Offer\'>\n                \n    <div class=\'price-box\'>\n                                                            <span class=\'regular-price\' id=\'product-price-51746\' itemprop=\'price\'>\n                                           <span class=\'price\'>65,00\u00a0EUR<\/span>                                    <\/span>\n                        \n    \n        \n    <\/div>\n\n        <meta itemprop=\'priceCurrency\' content=\'EUR\' \/>\n        <meta itemprop=\'availability\' content=\'http:\/\/schema.org\/InStock \' \/>\n    <\/div>\n\n','price_numeric':65,'size':'L','id':51746,'parent_attribute_code':'size'},'18':{'qty':5,'stock_status':1,'sku':'6411254317877','price':'\n\n\n    <div class=\'price-wrapper\' itemprop=\'offers\' itemscope itemtype=\'http:\/\/schema.org\/Offer\'>\n                \n    <div class=\'price-box\'>\n                                                            <span class=\'regular-price\' id=\'product-price-51747\' itemprop=\'price\'>\n                                           <span class=\'price\'>65,00\u00a0EUR<\/span>                                    <\/span>\n                        \n    \n        \n    <\/div>\n\n        <meta itemprop=\'priceCurrency\' content=\'EUR\' \/>\n        <meta itemprop=\'availability\' content=\'http:\/\/schema.org\/InStock \' \/>\n    <\/div>\n\n','price_numeric':65,'size':'M','id':51747,'parent_attribute_code':'size'},'17':{'qty':78,'stock_status':1,'sku':'6411254317860','price':'\n\n\n    <div class=\'price-wrapper\' itemprop=\'offers\' itemscope itemtype=\'http:\/\/schema.org\/Offer\'>\n                \n    <div class=\'price-box\'>\n                                                            <span class=\'regular-price\' id=\'product-price-51748\' itemprop=\'price\'>\n                                           <span class=\'price\'>65,00\u00a0EUR<\/span>                                    <\/span>\n                        \n    \n        \n    <\/div>\n\n        <meta itemprop=\'priceCurrency\' content=\'EUR\' \/>\n        <meta itemprop=\'availability\' content=\'http:\/\/schema.org\/InStock \' \/>\n    <\/div>\n\n','price_numeric':65,'size':'S','id':51748,'parent_attribute_code':'size'},'20':{'qty':7,'stock_status':1,'sku':'6411254317891','price':'\n\n\n    <div class=\'price-wrapper\' itemprop=\'offers\' itemscope itemtype=\'http:\/\/schema.org\/Offer\'>\n                \n    <div class=\'price-box\'>\n                                                            <span class=\'regular-price\' id=\'product-price-51749\' itemprop=\'price\'>\n                                           <span class=\'price\'>65,00\u00a0EUR<\/span>                                    <\/span>\n                        \n    \n        \n    <\/div>\n\n        <meta itemprop=\'priceCurrency\' content=\'EUR\' \/>\n        <meta itemprop=\'availability\' content=\'http:\/\/schema.org\/InStock \' \/>\n    <\/div>\n\n','price_numeric':65,'size':'XL','id':51749,'parent_attribute_code':'size'},'47':{'qty':4,'stock_status':1,'sku':'6411254317853','price':'\n\n\n    <div class=\'price-wrapper\' itemprop=\'offers\' itemscope itemtype=\'http:\/\/schema.org\/Offer\'>\n                \n    <div class=\'price-box\'>\n                                                            <span class=\'regular-price\' id=\'product-price-51750\' itemprop=\'price\'>\n                                           <span class=\'price\'>65,00\u00a0EUR<\/span>                                    <\/span>\n                        \n    \n        \n    <\/div>\n\n        <meta itemprop=\'priceCurrency\' content=\'EUR\' \/>\n        <meta itemprop=\'availability\' content=\'http:\/\/schema.org\/InStock \' \/>\n    <\/div>\n\n','price_numeric':65,'size':'XS','id':51750,'parent_attribute_code':'size'},'21':{'qty':0,'stock_status':0,'sku':'6411254317907','price':'\n\n\n    <div class=\'price-wrapper\' itemprop=\'offers\' itemscope itemtype=\'http:\/\/schema.org\/Offer\'>\n    <div class=\'price-box sold-out\'>\n        Tilap\u00e4isesti loppu    <\/div>\n        <meta itemprop=\'priceCurrency\' content=\'EUR\' \/>\n        <meta itemprop=\'availability\' content=\'http:\/\/schema.org\/OutOfStock \' \/>\n    <\/div>\n\n','price_numeric':65,'size':'XXL','id':51751,'parent_attribute_code':'size'}}"></div>
        
        <!-- Simulate the product info block -->
        <div class="product-essential" style="display: none">
            <div class="product-shop">
                <div class="product-name">
                    <h1>
                        <span style="color:rgb(255, 186, 25);">-50%</span> Feeni Ruusuruoho
                        <span class="product-secondary-name">-tunika</span>
                        <span class="product-color-variant product-color-variant-title">l.valkoinen, musta</span>
                    </h1>
                </div>
                
                <div class="product-shop">
                    <div class="price-box-configurable">
                        <div class="price-wrapper">
                            <div class="price-box">
                                <p class="old-price">
                                    <span class="price" id="old-price-42200">
                                        120,00 </span>
                                </p>
                                <p class="special-price">
                                    <span class="price" id="product-price-42200">
                                        60,00&nbsp;EUR </span>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class='store-inventory' id='inventory-app' data-product-params='{"id":"065808", "color":"601", "name": "Feeni Ruusuruoho -tunika"}'>
           
            <div class='store-inventory-toggle clearfix'>
                <div class='toggle-icon'></div>
                <div class='toggle-link' @click='toggleDropdown'>Katso saatavuus myymälöissä</div>
            </div>
            <div class='store-inventory-info' v-if='showDropdown'>

                <vue-select2 v-if='statesStore.selector.city'
                    @change="switchList" 
                    v-bind="{
                        className: 'city-selector',
                        placeholder: 'Choose City',
                        label: 'city',
                        options: statesStore.selector.city,
                        htmlOptions: false,
                        disableSearch: false
                    }"
                >
                </vue-select2>

                <!-- User guidance -->
                <div class='instruction'>
                    <div class='instruction-text'>
                        Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
                    </div>
                    <ul class="instruction-demo">
                        <li class='green'>
                            <span class='icon'></span>Varastossa</li>
                        <li class='orange'>
                            <span class='icon'></span>Vähän jäljellä</li>
                        <li class='red'>
                            <span class='icon'></span>Loppuunmyyty</li>
                    </ul>
                </div>

                <div class="store-list">
                    <template v-if='cityData'>
                        <store-inventory-list
                            v-for='(item, index) in cityData'
                            :store-name='item.title'
                            :contact='item.contact_details'
                            :own-store="typeof item.sizes !== 'undefined'"
                            :opening-hours="item.opening_hours"
                            :country-code='countryCode'
                            :sizes='item.sizes'
                            :key='item.storeId'
                            :index='index'
                            :store-type='item.storeType'
                            :store-id='item.company_store_id'
                            :product-mapping='productParams.product_mapping'
                        ></store-inventory-list>

                        <!-- Bootstrap Modal component to render store contact popup -->
                        <store-general-overlay 
                            v-if='statesStore.storeContactOverlay'
                            :modal-id='"store-contact-overlay"'
                            :key='"store-contact"'
                            :modal-title='statesStore.storeContactOverlay.name'
                            :show-modal='statesStore.storeContactOverlay'
                        >
                            <store-contact 
                                slot='body'
                                :store-contact='statesStore.storeContactOverlay'
                            ></store-contact>
                        </store-general-overlay>
                
                        <!-- Bootstrap Modal component to render reserve & collect window -->
                         <store-general-overlay 
                            v-if='statesStore.reservationForm.contact'
                            :modal-id='"reserve-overlay"'
                            :key='"reserve-overlay"'
                            :modal-title='"Reserve & Collect"'
                            :show-modal='statesStore.reservationForm.contact'
                        >
                            <div class='reserve-form' slot='body' v-if='!statesStore.reservationForm.reserveMsg'>
                                <reserve-product-block 
                                    :store-contact='statesStore.reservationForm.contact'
                                >
                                    <vue-select2 
                                        slot='size-selector'
                                        v-if='statesStore.selector.size'
                                        v-bind="{
                                            className: 'size-list',
                                            placeholder: 'Choose Size',
                                            label: 'size',
                                            options: statesStore.selector.size,
                                            htmlOptions: true,
                                            disableSearch: true,
                                            width: '100%'
                                        }"
                                        @change='updateSku'
                                    >
                                    </vue-select2>
                                </reserve-product-block>
                                <reserve-form-block
                                    :is-mobile='statesStore.screensize.mobile'
                                >
                                    <reserve-summary slot='summary'
                                        v-if='statesStore.screensize.mobile'
                                        :store-name='statesStore.reservationForm.contact.name'
                                    ></reserve-summary>
                                </reserve-form-block>
                                <div class="reserve-form--additional">
                                    <reserve-summary 
                                        v-if='!statesStore.screensize.mobile'
                                        
                                    ></reserve-summary>
                                    <div class='instruction-txt'>
                                        Varaus maksetaan myymälään. Saat viestin kun varauksesi on noudettavissa myymä-lästä. Sinulla on 24 tuntia aikaa noutaa varauksesi. Jos varausta ei noudeta, se peruuntuu automaattisesti. <br><br>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus finibus orci nec quam laoreet tincidunt. Nam sem risus, rhoncus ut scelerisque eu, tincidunt finibus libero. Sed ac volutpat arcu, vel suscipit ligula. Ut ultrices fringilla massa eu maximus.
                                    </div>
                                    <div class='contact-info'>
                                        <div class="store-name">
                                            {{statesStore.reservationForm.contact.name}}
                                        </div>
                                        <store-contact 
                                            :store-contact='statesStore.reservationForm.contact'
                                        ></store-contact> 
                                    </div>
                                </div>
                            </div>
                            <template slot='messages' v-else>
                                <div class="success-msg" v-show='statesStore.reservationForm.reserveMsg == "success"'>
                                    Thanks for make the reservation, the store will contact you when product is ready to pick up.
                                </div>
                                <div class="error-msg" v-show='statesStore.reservationForm.reserveMsg == "error"'>
                                    SOrry, something went wrong when doing the reservation request, please try again later.
                                </div>
                            </template>
                        </store-general-overlay>

                    </template>
                </div>
            </div>
        </div>
        
        <script type='text/x-template' id='reserve-summary-template'>
            <div class='reserve-form--summary'>
                <div class='summary-title'>
                    Reservation Summary
                </div>
                <div class='summary-product summary-row'>
                    <div class='product-name left-side'>                          
                        <span class='product-quantity' v-if='params.type == "onesize" && params.qty > 1'>{{params.qty}} x &nbsp;</span>{{params.name}}
                    </div>
                    <div class='product-price right-side' v-if='params.currencyAhead'>{{params.currency}}{{params.unitPrice}}</div>
                    <div class='product-price right-side' v-else>{{unitPrice}} {{params.currency}}</div>
                </div>
                <div class='summary-delivery summary-row'>
                    <div class="pickup-store left-side">
                        <div>Nouto myymälästä</div>
                        <div class='store-name'>{{storeName}}</div>
                    </div>
                    <div class="shipping-cost right-side" v-if='params.currencyAhead'>{{params.currency}}0</div>
                    <div class='shipping-cost right-side' v-else>0 {{params.currency}}</div>
                </div>
                <div class='summary-cost summary-row'>
                    <div class='txt left-side'>In total:</div>
                    <div class='amount right-side' v-if='params.currencyAhead'>{{params.currency}}{{finalPrice}}</div>
                    <div class='amount right-side' v-else>{{finalPrice}} {{params.currency}}</div>
                </div>
            </div>
        </script>

        <script type="text/x-template" id='store-general-overlay'>
            <div class="modal fade" :id="modalId" tabindex="-1" role="dialog" :aria-labelledby="modalId + '-label'">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <a class='close-section clearfix' data-dismiss="modal" aria-label="Close">
                                <div class='txt'>Close</div>
                                <div class="icon"></div>
                            </a>
                            <div class="modal-title" :id="modalId + '-label'">{{modalTitle}}</div>
                        </div>
                        <div class="modal-body clearfix">
                            <slot name='body'></slot>
                        </div>
                        <div class='modal-msg clearfix'>
                            <slot name='messages'></slot>    
                        </div>
                    </div>
                </div>
            </div>

        </script>

        <!-- Popup Contact Overlay -->
        <script type="text/x-template" id="store-contact-template">
            <div class="contact-wrapper">
                <div class='contact-section'>
                    {{storeContact.address[0]}}<br>
                    {{storeContact.address[1]}}<br>
                    {{storeContact.address[2]}}
                </div>
                <br>
                <div class='contact-section'>Avoinna:
                    <br>Arkisin {{storeContact.openingHours.weekday}}
                    <br>lauantai {{storeContact.openingHours.saturday}}
                    <br>sunnuntai {{storeContact.openingHours.sunday}}
                </div>
                <br>
                <div class='contact-section'>{{storeContact.phone}}</div>     
            </div>     
        </script>

        <!-- Store inventory block template -->
        <script type="text/x-template" id="store-inventory-template">
    
            <div class='store-item' :class="'store-item--' + productType">
                <div class='store-title'>
                    <span @click="setContactFormOverlay" class='store-title-name' title="<?php echo $this->__('Myymälän yhteystiedot');?>">{{storeName}}</span>
                    <span class='store-title-phone'>{{contact.phone}}</span>
                </div>
                <div class='store-status clearfix'>
                    <template v-if="ownStore">
                        <template v-if="productType === 'sizable'">
                            <div class='store-status-item'
                                v-for='size in sizes'
                                :class='getInventoryGroupClass(size.level)'
                            >{{size.product_size}}</div>
                        </template>
                        <div class='store-status-item'
                            :class='getInventoryGroupClass(sizes[0].level)'
                            v-else
                        >{{oneSizeMapping[locale][sizes[0].level]}}</div>
                    </template>
                    <template v-else>
                        <div class="store-status-item--null">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</div>
                    </template>
                </div>
                <template v-if='hasInventory'>
                    <!-- Reserve & collect button -->
                    <a @click='prepareReserveForm' class="reserve-btn mari-btn mari-btn-lg mari-btn-secondary">Varaa myymälössä</a>
                </template>
            </div>
        </script>

        <script type='text/x-template' id='reserve-product-template'>
            <div class='reserve-form--product'>
                <div class='store'>
                    <div class="store-icon"></div>
                    <div class="store-info">
                        <div class="store-info--name">{{storeContact.name}}</div>
                        <div class="store-info--phone">{{storeContact.phone}}</div>
                    </div>
                </div>
                <div class='product-attribute'>
                    <div class="left-side">
                        <img class='product-img' src="dest/img/test_product.jpg">
                    </div>
                    <div class="right-side">
                        <div class="product-name">
                            <h1>
                                <span style="color:rgb(255, 186, 25);">-50%</span> Feeni Ruusuruoho
                                <span class="product-secondary-name">-tunika</span>
                                <span class="product-color-variant product-color-variant-title">l.valkoinen, musta</span>
                            </h1>
                        </div>
                        <div class='product-price'>
                            <p class="old-price">
                                <span class="price" id="old-price-42200">
                                    120,00 </span>
                            </p>
                            <p class="special-price">
                                <span class="price" id="product-price-42200">
                                    60,00&nbsp;EUR </span>
                            </p>
                        </div>
                        <div class='attribute-selector qty-selector' v-if="productType === 'onesize'">
                            <span class="qty-minus"></span>
                            <span class="qty-val">1</span>
                            <input type="number" hidden min='1' max='10' class="qty-input" value="1">
                            <span class="qty-plus"></span>
                        </div>
                        <div class='attribute-selector size-selector' v-else>
                            <slot name='size-selector'></slot>
                        </div>
                    </div>
                </div>
            </div>
        </script>

        <script type='text/x-template' id='reserve-form-template'>
        
            <div class='reserve-form--contact'>
                <div class='form-title'>Personal info</div>
                <label for="reservation-fname" class="form-field">First name <span>*</span></label>
                <input @change='validateFormInput' type='text' class='mari-input mari-input--text mari-input--text-xs mari-input--text-primary' pattern='[a-zA-Z]+' required id='reservation-fname' v-model='fn'>
                <label for="reservation-lname" class="form-field">Family name <span>*</span></label>
                <input @change='validateFormInput' type='text' class='mari-input mari-input--text mari-input--text-xs mari-input--text-primary' pattern='[a-zA-Z]+' required id='reservation-lname' v-model='ln'>
                <label for="reservation-email" class="form-field">Email address <span>*</span></label>
                <input @change='validateFormInput' class='mari-input mari-input--text mari-input--text-xs mari-input--text-primary' 
                    pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,3}$" required id='reservation-email' v-model='email'>
                <label for="reservation-phone" class="form-field">Phone number <span>*</span></label>
                <input @change='validateFormInput' class='mari-input mari-input--text mari-input--text-xs mari-input--text-primary' pattern="\+?\d{3}-?\d{6,}" required id='reservation-phone' v-model='tel'>
                <div class='form-info'>* All fields are required</div>
                <slot name='summary'></slot>
                <div class='btn-section'>
                    <button @click='checkReserveFormValidity' class='reserve-submit mari-btn mari-btn-lg mari-btn-primary'>Reserve</button>
                    <button class='reserve-cancel mari-btn mari-btn-lg mari-btn-secondary' data-dismiss="modal" aria-label="Close">Cancel</button>
                </div>
            </div>
        
        </script>

        <script type='text/x-template' id='vue-select2-component'>
            <div class='select2-component-wrapper'>
                <select :class='className' required>
                    <slot></slot>
                </select>
                <div :id='dropDownWrapperId'></div>
            </div>
        </script>

    </div>



</body>

</html>